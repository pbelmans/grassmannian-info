{% macro dynkin(T, n, height=20, k=[]) %}
{% if T in ["B", "C"] and n == 1 %}{{ dynkin("A", 1, height=height, k=k) }}
{% else %}
<svg height="{{ height }}" id="dynkin-{{ T }}{{ n}}" viewBox="-10 -10 {% if T == "D" %}{{ n * 20 - 20 }}{% elif T in ["D", "E"] %}{{ n * 20 - 10 }}{% else %}{{ n * 20 }}{% endif %} 40">
  <g style="stroke-width:1; stroke-linejoin:bevel; stroke-linecap:butt; stroke:black; fill:white">
    {% if T == "A" %}
      <polyline points="0,10 {{ (n - 1) * 20 }},10" />
      {% for i in range(n) %}
        <circle cx="{{ i * 20 }}" cy="10" r="5" data-label="A{{ n }}-{{ i + 1 }}" {% if i + 1 in k %}class="active"{% endif %} />
        <!--<text x="{{ i * 20 - 5 }}" y="10">{{ i + 1 }}</text>-->
      {% endfor %}
    {% elif T == "B" and n >= 2%}
      <polyline points="{{ (n - 2) * 20 + 7 }},17 {{ (n - 2) * 20 + 13 }},10 {{ (n - 2) * 20 + 7 }},3" />
      <polyline points="0,10 {{ (n - 2) * 20 }},10" />
      <polyline points="{{ (n - 2) * 20 }},8 {{ (n - 1) * 20 }},8" />
      <polyline points="{{ (n - 2) * 20 }},12 {{ (n - 1) * 20 }},12" />
      {% for i in range(n) %}<circle cx="{{ i * 20 }}" cy="10" r="5" data-label="B{{ n }}-{{ i + 1 }}" {% if i + 1 in k %}class="active"{% endif %} />{% endfor %}
    {% elif T == "C" %}
      <polyline points="{{ (n - 2) * 20 + 13 }},17 {{ (n - 2) * 20 + 7 }},10 {{ (n - 2) * 20 + 13 }},3" />
      <polyline points="0,10 {{ (n - 2) * 20 }},10" />
      <polyline points="0,10 {{ (n - 2) * 20 }},10" />
      <polyline points="{{ (n - 2) * 20 }},8 {{ (n - 1) * 20 }},8" />
      <polyline points="{{ (n - 2) * 20 }},12 {{ (n - 1) * 20 }},12" />
      {% for i in range(n) %}<circle cx="{{ i * 20 }}" cy="10" r="5" data-label="C{{ n }}-{{ i + 1 }}" {% if i + 1 in k %}class="active"{% endif %} />{% endfor %}
    {% elif T == "D" %}
      {% if n >= 3 %}
        <polyline points="0,10 {{ (n - 3) * 20 }},10" />
        <polyline points="{{ (n - 3) * 20 }},10 {{ (n - 2) * 20 }},0" />
        <polyline points="{{ (n - 3) * 20 }},10 {{ (n - 2) * 20 }},20" />
      {% endif %}
      {% for i in range(n - 2) %}<circle cx="{{ i * 20 }}" cy="10" r="5" data-label="D{{ n }}-{{ i + 1 }}" {% if i + 1 in k %}class="active"{% endif %} />{% endfor %}
      <circle cx="{{ (n - 2) * 20 }}" cy="0" r="5" data-label="D{{ n }}-{{ n - 1 }}"  {% if n - 1 in k %}class="active"%{% endif %}/>
      <circle cx="{{ (n - 2) * 20 }}" cy="20" r="5" data-label="D{{ n }}-{{ n }}" {% if n in k %}class="active"%{% endif %}/>
    {% elif T == "E" %}
      <polyline points="0,20 {{ (n - 2) * 20 }},20" />
      <polyline points="40,20 40,0" />
      <circle cx="0" cy="20" r="5" data-label="E{{ n }}-1" {% if 1 in k %}class="active"%{% endif %} />
      {% for i in range(1, n - 1) %}<circle cx="{{ i * 20 }}" cy="20" r="5" data-label="E{{ n }}-{{ i + 2 }}" {% if i + 2 in k %}class="active"{% endif %} />{% endfor %}
      <circle cx="40" cy="0" r="5" data-label="E{{ n }}-2" {% if 2 in k %}class="active"%{% endif %} />
    {% elif T == "F" %}
      <polyline points="27,17 33,10 27,3" />
      <polyline points="0,10 20,10" />
      <polyline points="20,8 40,8" />
      <polyline points="20,12 40,12" />
      <polyline points="40,10 60,10" />
      {% for i in range(n) %}<circle cx="{{ i * 20 }}" cy="10" r="5" data-label="F4-{{ i + 1 }}" {% if i + 1 in k %}class="active"{% endif %} />{% endfor %}
    {% elif T == "G" %}
      <polyline points="13,17 7,10 13,3" />
      <polyline points="0,10 20,10" />
      <polyline points="0,7 20,7" />
      <polyline points="0,13 20,13" />
      {% for i in range(n) %}<circle cx="{{ i * 20 }}" cy="10" r="5" data-label="G2-{{ i + 1 }}" {% if i + 1 in k %}class="active"{% endif %}/>{% endfor %}
    {% endif %}
  </g>
</svg>
{% endif %}
{% endmacro %}


{% macro adjoint_group(D) %}
{% set T = D[0] %}
{% set n = D[1:] | int %}

{# we write the adjoint form (per Demazure's article), notation taken from Humphreys, Linear algebraic groups, page 215 #}
{% if T == "A" -%}$\mathrm{PGL}_{ {{ n + 1 }} }$
{%- elif T == "B" -%}$\mathrm{SO}_{ {{ 2*n + 1 }} }$
{%- elif T == "C" -%}$\mathrm{PSp}_{ {{ 2*n }} }$
{%- elif T == "D" -%}$\mathrm{PSO}_{ {{ 2*n }} }$
{%- elif T == "E" -%}adjoint group of type $\mathrm{E}_{ {{ n }} }$
{%- elif T == "F" -%}$\mathrm{F}_4$
{%- elif T == "G" -%}$\mathrm{G}_2$
{%- endif %}
{% endmacro %}


{% macro component(title, content, id="") %}
<div id="{{ id }}" class="card mb-4">
  <div class="card-header">{{- title }}</div>

  <div class="card-body">
    {{ content }}
  </div>
</div>
{% endmacro %}


{% macro type(G) -%}
  {%- if G.is_cominuscule() -%}cominuscule {% endif %}
  {%- if G.is_minuscule() -%}minuscule {% endif %}
  {%- if G.is_adjoint() -%}adjoint {% endif %}
  {%- if G.is_coadjoint() -%}coadjoint{% endif %}
{%- endmacro %}


{% macro data(G) -%}
data-dimension="{{ G.dimension() }}" data-index="{{ G.index() }}" data-euler="{{ G.rank() }}" data-name="{{ G.name() | safe }}" data-derived="{% if G.exceptional_sequences() %}exceptional{% endif %}"
{%- endmacro %}


{% macro entry(G) %}
<td class="entry" data-type="{{ type(G) }}" {{ data(G) }} data-label="{{ G.D.T }}{{ G.D.n }}-{{ G.k }}">
  <div class="alpha">
    <a href="/{{ G.D.T }}{{ G.D.n }}/{{ G.k }}">{{ G.html() | safe }}</a>

    <div class="information">
      \begin{align*}
        d&={{ G.dimension() }} \\
        i&={{ G.index() }} \\
        \chi&={{ G.rank() }}
      \end{align*}
    </div>
  </div>
</td>
{% endmacro %}


{% macro reference_link(reference) -%}
{% if reference[0:2] == "MR" -%}<a href="https://mathscinet.ams.org/mathscinet-getitem?mr={{ reference }}">{{ reference }}</a>
{%- else %}<a href="https://arxiv.org/abs/{{ reference }}">arXiv:{{ reference }}</a>{% endif %}
{%- endmacro %}
