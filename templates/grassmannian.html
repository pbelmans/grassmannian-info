{% extends "page.html" %}

{% import "macros.html" as macros %}

{% block title %}{{ grassmannian["name"] }} {{ grassmannian["plaintext"] }}{% endblock %}
{# TODO nice human-readable name #}

{% macro component(title, content, id="") %}
<div id="{{ id }}" class="card" style="min-width: 1px">
  <div class="card-header">{{- title }}</div>

  <div class="card-body">
    {{ content }}
  </div>
</div>
{% endmacro %}


{% macro basic(grassmannian) %}
<dl class="row">
  <dt class="col-3 text-right">dimension
  <dd class="col-9">{{ grassmannian["dimension"] }}

  <dt class="col-3 text-right">index
  <dd class="col-9">{{ grassmannian["index"] }}

  <dt class="col-3 text-right">Euler characteristic
  <dd class="col-9">{{ grassmannian["rank"] }}

  <dt class="d-lg-none col-3 text-right">Betti numbers
  <dd class="d-lg-none col-9">{{ betti_horizontal(grassmannian) }}

  <dt class="col-3 text-right">$\mathrm{Aut}^0({{ grassmannian["latex"] }})$
  <dd class="col-9">{{ macros.adjoint_group(grassmannian["Aut^0"]) }}

  <dt class="col-3 text-right">$\pi_0\mathrm{Aut}({{ grassmannian["latex"] }})$
  <dd class="col-9">${{ grassmannian["pizero"] }}$

  <dt class="col-3 text-right">$\dim\mathrm{Aut}^0({{ grassmannian["latex"] }})$
  <dd class="col-9">{{ grassmannian["dim Aut"] }}
</dl>
{% endmacro %}


{% macro hpd(grassmannian) %}
<svg class="lefschetz" viewBow="0 0 {{ grassmannian["hpd"]["support"][0] * 20 }} {{ grassmannian["hpd"]["total"] * 20 }}">
  {% for i in range(grassmannian["hpd"]["total"]) %}
    {% for j in range(grassmannian["hpd"]["support"][0]) %}
    <rect x="{{ i * 20 }}" y="{{ j * 20 }}" width="20" height="20" class="block{% if i < grassmannian["hpd"]["support"] | length and j < grassmannian["hpd"]["support"][i] %} original{% endif %} " />
    {% endfor %}
  {% endfor %}
</svg>
{% endmacro %}


{% macro betti_vertical(grassmannian) %}
\begin{align*}
{%- for betti in grassmannian["betti"] %}
  \mathrm{b}_{ {{ loop.index }} } &= {{ betti }} {% if not loop.last %}\\{% endif %}
{%- endfor %}
\end{align*}
{% endmacro %}

{% macro betti_horizontal(grassmannian) %}
{%- for betti in grassmannian["betti"] -%}
  $\mathrm{b}_{ {{ loop.index }} } = {{ betti }}${% if not loop.last %}, {% endif %}
{%- endfor %}
{% endmacro %}


{% macro projective(grassmannian) %}
<dl class="row">
  <dt class="col-3 text-right">minimal embedding
  <dd class="col-9"><p>${{ grassmannian["latex"] }}\hookrightarrow\mathbb{P}^{ {{ grassmannian["embedding"] }} }$</p>
  {% if grassmannian["type"][0] == "C" and grassmannian["parabolic"] == 1 %}<p>More appropriately in this particular presentation as a quotient of the symplectic group is to consider the Grassmannian as the <strong>adjoint variety of type $\mathrm{C}_{ {{ grassmannian["type"][1:] }} }$</strong>, where the embedding is the second Veronese embedding into $\mathbb{P}(\mathrm{V}_{2\omega_1})=\mathbb{P}^{ {{ (grassmannian["embedding"] * (grassmannian["embedding"] + 3) / 2) | int }} }$.{% endif %}
  <dt class="col-3 text-right">degree
  <dd class="col-9">{{ grassmannian["degree"] }}

  <!--
  <dt class="col-3 text-right">Hilbert polynomial
  <dd class="col-9">\begin{equation}{{ grassmannian["hilbert_polynomial"]["latex"] }}\end{equation}

    \begin{equation}
    {% for factor in grassmannian["hilbert_polynomial"]["factors"] %}
      {% if factor == "1" %}(t+1)
      {% else %}\left( \frac{ {{ factor.split("/")[0] }} }{ {{ factor.split("/")[1] }} }t+1 \right)
      {% endif %}
    {% endfor %}
    \end{equation}
  -->

  <dt class="col-3 text-right">Hilbert series
  <dd class="col-9">
    {% for dimension in grassmannian["hilbert_polynomial"]["evaluation"] -%}
      {{- dimension -}}
      {%- if not loop.last %}, {% endif %}
    {%- endfor -%}, ...
    <!-- TODO implement JS evaluation of Hilbert polynomial for more and more -->
</dl>
{% endmacro %}


{% block content %}
<div class="text-center">
  <h2 class="mt-3">{{ grassmannian["name"][0] | upper  }}{{ grassmannian["name"][1:] }} ${{ grassmannian["latex"] }}$</h2>

  {{ macros.dynkin(grassmannian["type"][0], grassmannian["type"][1:] | int, height=100, k=[grassmannian["parabolic"]]) }}
</div>

<div class="row">
  <div class="col-2 d-none d-lg-block">
    {{ component("Betti numbers", betti_vertical(grassmannian)) }}
  </div>

  <div class="col-12 col-lg-10">
    {{ component("Basic information", basic(grassmannian)) }}

    {{ component("Projective geometry", projective(grassmannian)) }}

    {{ component("Homological projective duality", hpd(grassmannian)) }}
  </div>
</div>


<script type="text/javascript">
  // TODO figure out why this doesn't work...
  $("circle").wrap(function() {
    //return "<a href='/" + $(this).data("label") + "'></a>";
  });
</script>
{% endblock %}
